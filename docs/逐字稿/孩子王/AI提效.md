# AI 提效

公司内部在推 AI Coding 开发，旨在一个小项目，例如后台页面等一些小需求，在前端/后端开发排期满的情况下，可以自行解决错误和需求的修改。

初步只是采用外部的大模型（例如 Claude Code）进行代码生成，接入 MCP 工具让 AI 生成的代码更符合企业要求，目前 AI 的缺点有：

1. 代码规范
2. 项目登录态
3. 错误需要手动 copy（例如：浏览器控制台报错）
4. 前后端联调困难（前后端定义的接口状态码、参数不一致）
5. 需求迭代，通过输入框描述，大模型会出现“乱改”情况
6. 公司内部的 sdk、组件库文档 AI 无法使用（因为获取不到文档）
7. CI/CD

## 代码规范


通过将前端代码规范写入内部 cli 工具的 prompt 中即可，例如 ide 的 rules

## 项目登录态

通过 PlayWright 模拟登录，并获取登录态，再丢给大模型上下文，AI 自检的时候塞入登录态完成登录校验

## 错误自检

MCP 工具：监控浏览器控制台报错、终端错误信息，返回给 AI，让 AI 进行错误自检

监控的事件有：

- page.on('console')：监听控制台消息
- page.on('pageerror')：捕获并记录页面抛出的 JavaScript 错误
- page.on('requestfailed')：监听网络请求失败事件

## 前后端联调

现阶段前后端自测+联调耗时较长，经过摸底，耗时主要在以下几个方面：接口录入、接口转为前端代码、mock 数据生成。

目前存在的问题包括：

1. 接口文档维护不及时，导致前后端理解不一致；
2. 手动编写接口调用代码效率低下；
3. mock 数据缺乏真实性，无法充分验证业务逻辑；
4. 联调过程中频繁的沟通协调消耗大量时间。

这些问题不仅影响了开发效率，也降低了代码质量和项目的整体交付速度。

目标是通过引入 AI 能力，实现接口文档的智能生成和维护，自动化的代码生成，以及更真实的 mock 数据模拟。让前后端开发能够无缝对接，大大减少联调阶段的沟通成本和问题排查时间，最终实现开发效率的质的提升。

接口文档获取：在 cli 中，去拉去接口文档，解析接口参数、端点、请求示例，提取关键字段生成结构化 prompt，AI 可以根据该内容生成符合规范的接口和 Mock 数据。

接口校验：验证 API 接口错误返回信息。当通过 monitor_console_log（错误自检）工具捕获到失败的接口请求时，使用此工具重新发送请求以验证错误详情

# AI Coding 分享

在 AI 应用的消息格式扩展需求中，由于 AI 回复的 Markdown 内容需支持丰富 UI 组件展示，重点探究了 MDX 和 Web Component 两种扩展方案。

MDX 方案借助`@mdx-js/mdx`库实现，天然支持 JSX 语法，能将 AI 回复的纯文本标签解析为 React 组件，扩展和渲染都较为便捷，且能保证 UI 统一，适配 React 框架。核心是通过 compile 编译 MDX 内容为 JavaScript 函数体，再经 run 函数结合 React 运行时环境生成可渲染的 React 组件，最终传入自定义组件配置完成渲染。

Web Component 方案则利用浏览器原生支持的自定义标签能力，让 AI 回复的 HTML 标签直接渲染为对应组件，渲染逻辑简单，但写法相对繁琐；同时考虑到 React、Vue 框架下组件库 UI 统一的需求，需规避 Shadow DOM 导致的样式隔离问题，不创建 Shadow DOM，而是在自定义元素内部创建容器节点，像挂载根组件一样挂载 React 组件（如 Antd 组件），以此保证样式和组件正常渲染。

此外，针对 AI 生成页面的前端在线运行需求，可借助 Web Containers 技术，该技术能在浏览器中运行 Node 代码，具备虚拟文件系统和终端，只需将 AI 返回的 JSON 数据转换为 Web Containers 所需的文件树结构，即可实现在不依赖后端的情况下运行项目。
